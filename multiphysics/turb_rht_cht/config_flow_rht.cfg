%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                              %
% SU2 configuration file                                                       %
% Case description: Turbulent multiphysics with RHT and CHT - flow             %
% Author: Ruben Sanchez                                                        %
% Institution: Chair for Scientific Computing, TU Kaiserslautern               %
% Date: 2020-02-17                                                             %
% File Version 7.0.2 "Blackbird"                                               %
%                                                                              %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%
% SOLVER TYPE
%%%%%%%%%%%%%%%%%%%%%%% 

SOLVER= INC_RANS
KIND_TURB_MODEL= SST

%%%%%%%%%%%%%%%%%%%%%%%
% FLOW PROPERTIES
%%%%%%%%%%%%%%%%%%%%%%%

INC_DENSITY_MODEL= VARIABLE
INC_ENERGY_EQUATION = YES
INC_VELOCITY_INIT= ( 1.0, 0.0, 0.0 )
INC_DENSITY_INIT= 0.006
INC_TEMPERATURE_INIT= 450

INC_NONDIM = DIMENSIONAL

VISCOSITY_MODEL= CONSTANT_VISCOSITY
MU_CONSTANT= 1e-5

CONDUCTIVITY_MODEL= CONSTANT_CONDUCTIVITY
KT_CONSTANT= 0.01

FLUID_MODEL= INC_IDEAL_GAS
SPECIFIC_HEAT_CP= 1000
MOLECULAR_WEIGHT= 30

BODY_FORCE= YES
BODY_FORCE_VECTOR= ( 0.0, -9.81, 0.0 )

%%%%%%%%%%%%%%%%%%%%%%%
% RADIATION MODEL
%%%%%%%%%%%%%%%%%%%%%%%

RADIATION_MODEL = P1
MARKER_EMISSIVITY= ( upper, 0.0, lower, 0.0, left, 1.0, right, 1.0, inlet, 1.0, outlet, 1.0 )
ABSORPTION_COEFF = 1.0
CFL_NUMBER_RAD = 1E12
TIME_DISCRE_RADIATION= EULER_IMPLICIT

%%%%%%%%%%%%%%%%%%%%%%%
% HEAT SOURCE MODEL
%%%%%%%%%%%%%%%%%%%%%%%

HEAT_SOURCE = YES
HEAT_SOURCE_VAL = 50000
HEAT_SOURCE_ROTATION_Z = 0
HEAT_SOURCE_CENTER = (0.2,0.875,0)
HEAT_SOURCE_AXES = (0.2,0.05,0)

%%%%%%%%%%%%%%%%%%%%%%%
% INPUT
%%%%%%%%%%%%%%%%%%%%%%%

MESH_FORMAT= SU2
MESH_FILENAME= mesh_flow_ffd.su2

%%%%%%%%%%%%%%%%%%%%%%%
% BOUNDARY CONDITIONS
%%%%%%%%%%%%%%%%%%%%%%%

MARKER_ISOTHERMAL= ( left, 600.0 )
MARKER_HEATFLUX= ( upper, 0.0, lower, 0.0, )
MARKER_PLOTTING= ( right )
MARKER_MONITORING= ( right )

INC_INLET_TYPE= VELOCITY_INLET
MARKER_INLET= ( inlet, 450.0, 3.0, 1.0, 0.0, 0.0)

INC_OUTLET_TYPE = PRESSURE_OUTLET
MARKER_OUTLET= ( outlet, 0.0 )

%%%%%%%%%%%%%%%%%%%%%%%
% COUPLING CONDITIONS
%%%%%%%%%%%%%%%%%%%%%%%

MARKER_CHT_INTERFACE= (right)

%%%%%%%%%%%%%%%%%%%%%%%
% SOLUTION METHOD
%%%%%%%%%%%%%%%%%%%%%%%

INNER_ITER = 1

NUM_METHOD_GRAD= WEIGHTED_LEAST_SQUARES
CFL_NUMBER= 100

CONV_NUM_METHOD_FLOW= FDS
MUSCL_FLOW= YES
SLOPE_LIMITER_FLOW= NONE
TIME_DISCRE_FLOW= EULER_IMPLICIT

CONV_NUM_METHOD_TURB= SCALAR_UPWIND
MUSCL_TURB= NO
SLOPE_LIMITER_TURB= VENKATAKRISHNAN
TIME_DISCRE_TURB= EULER_IMPLICIT

%%%%%%%%%%%%%%%%%%%%%%%
% LINEAR SOLVER
%%%%%%%%%%%%%%%%%%%%%%%

LINEAR_SOLVER= FGMRES
LINEAR_SOLVER_PREC= ILU
LINEAR_SOLVER_ERROR= 1E-8
LINEAR_SOLVER_ITER= 10

%%%%%%%%%%%%%%%%%%%%%%%
% OUTPUT
%%%%%%%%%%%%%%%%%%%%%%%

HISTORY_OUTPUT = (ITER, RMS_RES, HEAT, CFL_NUMBER)

TABULAR_FORMAT= CSV
OUTPUT_FILES = (RESTART, PARAVIEW)

SOLUTION_FILENAME = solution_flow_rht
RESTART_FILENAME = restart_flow_rht
VOLUME_FILENAME = volume_flow_rht
CONV_FILENAME= history_flow_rht

SOLUTION_ADJ_FILENAME = solution_adj_flow_rht
RESTART_ADJ_FILENAME = restart_adj_flow_rht
VOLUME_ADJ_FILENAME = volume_adj_flow_rht

%%%%%%%%%%%%%%%%%%%%%%%
% PROJECTION SETTINGS
%%%%%%%%%%%%%%%%%%%%%%%

DV_KIND= FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D, FFD_CONTROL_POINT_2D
DV_MARKER = (( upper ), (lower))
DV_PARAM = ( UPPER_BOX, 0, 1, 0.0, 1.0 ); ( UPPER_BOX, 1, 1, 0.0, 1.0 ); ( UPPER_BOX, 2, 1, 0.0, 1.0 ); ( UPPER_BOX, 3, 1, 0.0, 1.0 ); ( UPPER_BOX, 4, 1, 0.0, 1.0 ); ( UPPER_BOX, 5, 1, 0.0, 1.0 ); ( UPPER_BOX, 6, 1, 0.0, 1.0 ); ( UPPER_BOX, 7, 1, 0.0, 1.0 ); ( UPPER_BOX, 8, 1, 0.0, 1.0 ); ( UPPER_BOX, 9, 1, 0.0, 1.0 ); ( UPPER_BOX, 10, 1, 0.0, 1.0 ); ( UPPER_BOX, 11, 1, 0.0, 1.0 ); ( LOWER_BOX, 0, 0, 0.0, 1.0 ); ( LOWER_BOX, 1, 0, 0.0, 1.0 ); ( LOWER_BOX, 2, 0, 0.0, 1.0 ); ( LOWER_BOX, 3, 0, 0.0, 1.0 ); ( LOWER_BOX, 4, 0, 0.0, 1.0 ); ( LOWER_BOX, 5, 0, 0.0, 1.0 ); ( LOWER_BOX, 6, 0, 0.0, 1.0 ); ( LOWER_BOX, 7, 0, 0.0, 1.0 ); ( LOWER_BOX, 8, 0, 0.0, 1.0 ); ( LOWER_BOX, 9, 0, 0.0, 1.0 ); ( LOWER_BOX, 10, 0, 0.0, 1.0 ); ( LOWER_BOX, 11, 0, 0.0, 1.0 )
DV_VALUE = 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0

